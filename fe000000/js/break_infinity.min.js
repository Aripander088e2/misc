(function(h,o){typeof exports=="object"&&typeof module<"u"?module.exports=o():typeof define=="function"&&define.amd?define(o):(h=typeof globalThis<"u"?globalThis:h||self,h.Decimal=o())})(this,function(){"use strict";var z=Object.defineProperty;var Y=(h,o,f)=>o in h?z(h,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[o]=f;var E=(h,o,f)=>(Y(h,typeof o!="symbol"?o+"":o,f),f);const _=[];for(let n=-324+1;n<=308;n++)_.push(Number("1e"+n));const x=323;function d(n){return _[n+x]}function F(n){let t="";for(;t.length<n;)t+="0";return t}const b=[];function w(n){if(n<=0)return"";const t=b[n];if(t!==void 0)return t;const r=F(n);return b[n]=r,r}function p(n){return n>0?"."+w(n):""}function A(n,t,r,i){const a=t.mul(r.pow(i));return s.floor(n.div(a).mul(r.sub(1)).add(1).log10()/r.log10())}function X(n,t,r,i){return t.mul(r.pow(i)).mul(s.sub(1,r.pow(n))).div(s.sub(1,r))}function P(n,t,r,i){const m=t.add(i.mul(r)).sub(r.div(2)),g=m.pow(2);return m.neg().add(g.add(r.mul(n).mul(2)).sqrt()).div(r).floor()}function U(n,t,r,i){const a=t.add(i.mul(r));return n.div(2).mul(a.mul(2).plus(n.sub(1).mul(r)))}function L(n,t,r){return n.div(t).add(n.div(r))}function N(n,t){if(n.m===0){if(t.m===0)return 0;if(t.m<0)return 1;if(t.m>0)return-1}if(t.m===0){if(n.m<0)return-1;if(n.m>0)return 1}if(n.m>0)return t.m<0||n.e>t.e?1:n.e<t.e?-1:n.m>t.m?1:n.m<t.m?-1:0;if(n.m<0)return t.m>0||n.e>t.e?-1:n.e<t.e||n.m>t.m?1:n.m<t.m?-1:0;throw Error("Unreachable code")}const q=new Map;function l(n){let t=q.get(n);return t===void 0&&(t=Object.freeze(new s(n)),q.set(n,t)),t}const e=n=>n instanceof s?n:new s(n),u=(n,t)=>new s().fromMantissaExponent(n,t),c=(n,t)=>new s().fromMantissaExponent_noNormalize(n,t);class s{constructor(t){E(this,"mantissa",NaN);E(this,"exponent",NaN);t===void 0?(this.m=0,this.e=0):t instanceof s?this.fromDecimal(t):typeof t=="number"?this.fromNumber(t):this.fromString(t)}get m(){return this.mantissa}set m(t){this.mantissa=t}get e(){return this.exponent}set e(t){this.exponent=t}get s(){return this.sign()}set s(t){if(t===0){this.e=0,this.m=0;return}this.sgn()!==t&&(this.m=-this.m)}fromMantissaExponent(t,r){return!isFinite(t)||!isFinite(r)?this.fromDecimal(M):(this.m=t,this.e=r,this.normalize(),this)}static fromMantissaExponent(t,r){return new s().fromMantissaExponent(t,r)}fromMantissaExponent_noNormalize(t,r){return this.m=t,this.e=r,this}static fromMantissaExponent_noNormalize(t,r){return new s().fromMantissaExponent_noNormalize(t,r)}copyFrom(t){this.m=t.m,this.e=t.e}fromDecimal(t){return this.copyFrom(t),this}static fromDecimal(t){return new s().fromDecimal(t)}fromNumber(t){return isFinite(t)?t===0?(this.m=0,this.e=0,this):(this.e=Math.floor(Math.log10(Math.abs(t))),this.m=this.e===-324?t*10/1e-323:t/d(this.e),this.normalize(),this):this.fromMantissaExponent_noNormalize(t,0)}static fromNumber(t){return new s().fromNumber(t)}fromString(t){if(t=t.toLowerCase(),t.indexOf("e")!==-1){const r=t.split("e");return this.m=parseFloat(r[0]),isNaN(this.m)&&(this.m=1),this.e=parseFloat(r[1]),this.normalize()}if(t==="nan")return this.fromDecimal(M);if(this.fromNumber(parseFloat(t)),this.isNaN())throw Error("[DecimalError] Invalid argument: "+t);return this}static fromString(t){return new s().fromString(t)}fromValue(t){return t instanceof s?this.fromDecimal(t):typeof t=="number"?this.fromNumber(t):typeof t=="string"?this.fromString(t):(this.m=0,this.e=0,this)}static fromValue(t){return new s().fromValue(t)}static fromValue_noAlloc(t){return t instanceof s?t:new s(t)}abs(){return c(Math.abs(this.m),this.e)}static abs(t){return e(t).abs()}neg(){return c(-this.m,this.e)}static neg(t){return e(t).neg()}negate(){return this.neg()}static negate(t){return e(t).neg()}negated(){return this.neg()}static negated(t){return e(t).neg()}sgn(){return Math.sign(this.m)}static sgn(t){return e(t).sgn()}sign(){return this.sgn()}static sign(t){return e(t).sgn()}round(){return this.e<-1?new s(0):this.e<17?new s(Math.round(this.toNumber())):this}static round(t){return e(t).round()}floor(){return this.isFinite()?this.e<-1?Math.sign(this.m)>=0?new s(0):new s(-1):this.e<17?new s(Math.floor(this.toNumber())):this:this}static floor(t){return e(t).floor()}ceil(){return this.e<-1?Math.sign(this.m)>0?new s(1):new s(0):this.e<17?new s(Math.ceil(this.toNumber())):this}static ceil(t){return e(t).ceil()}trunc(){return this.e<0?new s(0):this.e<17?new s(Math.trunc(this.toNumber())):this}static trunc(t){return e(t).trunc()}add(t){if(!this.isFinite())return this;const r=e(t);if(!r.isFinite()||this.m===0)return r;if(r.m===0)return this;let i,a;if(this.e>=r.e?(i=this,a=r):(i=r,a=this),i.e-a.e>17)return i;const m=Math.round(1e14*i.m+1e14*a.m*d(a.e-i.e));return u(m,i.e-14)}static add(t,r){return e(t).add(r)}plus(t){return this.add(t)}static plus(t,r){return e(t).add(r)}sub(t){return this.add(e(t).neg())}static sub(t,r){return e(t).sub(r)}subtract(t){return this.sub(t)}static subtract(t,r){return e(t).sub(r)}static minus(t,r){return e(t).sub(r)}minus(t){return this.sub(t)}mul(t){if(typeof t=="number")return t<1e307&&t>-1e307?u(this.m*t,this.e):u(this.m*1e-307*t,this.e+307);const r=typeof t=="string"?new s(t):t;return u(this.m*r.m,this.e+r.e)}static mul(t,r){return e(t).mul(r)}multiply(t){return this.mul(t)}static multiply(t,r){return e(t).mul(r)}times(t){return this.mul(t)}static times(t,r){return e(t).mul(r)}div(t){return this.mul(e(t).recip())}static div(t,r){return e(t).div(r)}divide(t){return this.div(t)}static divide(t,r){return e(t).div(r)}divideBy(t){return this.div(t)}dividedBy(t){return this.div(t)}recip(){return u(1/this.m,-this.e)}static recip(t){return e(t).recip()}reciprocal(){return this.recip()}static reciprocal(t){return e(t).recip()}reciprocate(){return this.recip()}static reciprocate(t){return e(t).reciprocate()}cmp(t){const r=e(t);return this.isNaN()?r.isNaN()?0:-1:r.isNaN()?1:N(this,r)}static cmp(t,r){return e(t).cmp(r)}compare(t){return this.cmp(t)}static compare(t,r){return e(t).cmp(r)}eq(t){const r=e(t);return this.e===r.e&&this.m===r.m}static eq(t,r){return e(t).eq(r)}equals(t){return this.eq(t)}static equals(t,r){return e(t).eq(r)}neq(t){return!this.eq(t)}static neq(t,r){return e(t).neq(r)}notEquals(t){return this.neq(t)}static notEquals(t,r){return e(t).notEquals(r)}lt(t){const r=e(t);return this.m===0?r.m>0:r.m===0?this.m<=0:this.e===r.e?this.m<r.m:this.m>0?r.m>0&&this.e<r.e:r.m>0||this.e>r.e}static lt(t,r){return e(t).lt(r)}lessThan(t){if(this.isNaN())return!1;const r=e(t);return r.isNaN()?!1:N(this,r)<0}lte(t){return!this.gt(t)}static lte(t,r){return e(t).lte(r)}lessThanOrEqualTo(t){if(this.isNaN())return!1;const r=e(t);return r.isNaN()?!1:N(this,r)<1}gt(t){const r=e(t);return this.m===0?r.m<0:r.m===0?this.m>0:this.e===r.e?this.m>r.m:this.m>0?r.m<0||this.e>r.e:r.m<0&&this.e<r.e}static gt(t,r){return e(t).gt(r)}greaterThan(t){if(this.isNaN())return!1;const r=e(t);return r.isNaN()?!1:N(this,r)>0}gte(t){return!this.lt(t)}static gte(t,r){return e(t).gte(r)}greaterThanOrEqualTo(t){if(this.isNaN())return!1;const r=e(t);return r.isNaN()?!1:N(this,r)>-1}max(t){const r=e(t);return this.lt(r)?r:this}static max(t,r){return e(t).max(r)}min(t){const r=e(t);return this.gt(r)?r:this}static min(t,r){return e(t).min(r)}clamp(t,r){return this.max(t).min(r)}static clamp(t,r,i){return e(t).clamp(r,i)}clampMin(t){return this.max(t)}static clampMin(t,r){return e(t).clampMin(r)}clampMax(t){return this.min(t)}static clampMax(t,r){return e(t).clampMax(r)}cmp_tolerance(t,r){const i=e(t);return this.eq_tolerance(i,r)?0:this.cmp(i)}static cmp_tolerance(t,r,i){return e(t).cmp_tolerance(r,i)}compare_tolerance(t,r){return this.cmp_tolerance(t,r)}static compare_tolerance(t,r,i){return e(t).cmp_tolerance(r,i)}eq_tolerance(t,r){const i=e(t);return s.lte(this.sub(i).abs(),s.max(this.abs(),i.abs()).mul(r))}static eq_tolerance(t,r,i){return e(t).eq_tolerance(r,i)}equals_tolerance(t,r){return this.eq_tolerance(t,r)}static equals_tolerance(t,r,i){return e(t).eq_tolerance(r,i)}neq_tolerance(t,r){return!this.eq_tolerance(t,r)}static neq_tolerance(t,r,i){return e(t).neq_tolerance(r,i)}notEquals_tolerance(t,r){return this.neq_tolerance(t,r)}static notEquals_tolerance(t,r,i){return e(t).notEquals_tolerance(r,i)}lt_tolerance(t,r){const i=e(t);return!this.eq_tolerance(i,r)&&this.lt(i)}static lt_tolerance(t,r,i){return e(t).lt_tolerance(r,i)}lte_tolerance(t,r){const i=e(t);return this.eq_tolerance(i,r)||this.lt(i)}static lte_tolerance(t,r,i){return e(t).lte_tolerance(r,i)}gt_tolerance(t,r){const i=e(t);return!this.eq_tolerance(i,r)&&this.gt(i)}static gt_tolerance(t,r,i){return e(t).gt_tolerance(r,i)}gte_tolerance(t,r){const i=e(t);return this.eq_tolerance(i,r)||this.gt(i)}static gte_tolerance(t,r,i){return e(t).gte_tolerance(r,i)}log10(){return this.e+Math.log10(this.m)}static log10(t){return e(t).log10()}absLog10(){return this.e+Math.log10(Math.abs(this.m))}static absLog10(t){return e(t).absLog10()}pLog10(){return this.m<=0||this.e<0?0:this.log10()}static pLog10(t){return e(t).pLog10()}log(t){return Math.LN10/Math.log(t)*this.log10()}static log(t,r){return e(t).log(r)}logarithm(t){return this.log(t)}static logarithm(t,r){return e(t).log(r)}log2(){return 3.321928094887362*this.log10()}static log2(t){return e(t).log2()}ln(){return 2.302585092994045*this.log10()}static ln(t){return e(t).ln()}static pow10(t){return Number.isInteger(t)?c(1,t):u(Math.pow(10,t%1),Math.trunc(t))}pow(t){if(this.m===0)return this;const r=t instanceof s?t.toNumber():t,i=this.e*r;let a;if(Number.isSafeInteger(i)&&(a=Math.pow(this.m,r),isFinite(a)&&a!==0))return u(a,i);const m=Math.trunc(i),g=i-m;if(a=Math.pow(10,r*Math.log10(this.m)+g),isFinite(a)&&a!==0)return u(a,m);const I=s.pow10(r*this.absLog10());return this.sign()===-1?Math.abs(r%2)===1?I.neg():Math.abs(r%2)===0?I:M:I}static pow(t,r){return typeof t=="number"&&t===10&&typeof r=="number"&&Number.isInteger(r)?c(1,r):e(t).pow(r)}exp(){const t=this.toNumber();return-706<t&&t<709?s.fromNumber(Math.exp(t)):s.pow(Math.E,t)}static exp(t){return e(t).exp()}sqr(){return u(Math.pow(this.m,2),this.e*2)}static sqr(t){return e(t).sqr()}sqrt(){return this.m<0?M:this.e%2!==0?u(Math.sqrt(this.m)*3.16227766016838,Math.floor(this.e/2)):u(Math.sqrt(this.m),Math.floor(this.e/2))}static sqrt(t){return e(t).sqrt()}cube(){return u(Math.pow(this.m,3),this.e*3)}static cube(t){return e(t).cube()}cbrt(){let t=1,r=this.m;r<0&&(t=-1,r=-r);const i=t*Math.pow(r,1/3),a=this.e%3;return a===1||a===-2?u(i*2.154434690031883,Math.floor(this.e/3)):a!==0?u(i*4.641588833612778,Math.floor(this.e/3)):u(i,Math.floor(this.e/3))}static cbrt(t){return e(t).cbrt()}dp(){if(!this.isFinite())return NaN;if(this.exponent>=17)return 0;const t=this.mantissa;let r=-this.exponent,i=1;for(;Math.abs(Math.round(t*i)/i-t)>1e-10;)i*=10,r++;return r>0?r:0}static dp(t){return e(t).dp()}decimalPlaces(){return this.dp()}static decimalPlaces(t){return e(t).dp()}static affordGeometricSeries(t,r,i,a){return A(e(t),e(r),e(i),a)}static sumGeometricSeries(t,r,i,a){return X(t,e(r),e(i),a)}static affordArithmeticSeries(t,r,i,a){return P(e(t),e(r),e(i),e(a))}static sumArithmeticSeries(t,r,i,a){return U(e(t),e(r),e(i),e(a))}static efficiencyOfPurchase(t,r,i){return L(e(t),e(r),e(i))}static randomDecimalForTesting(t){if(Math.random()*20<1)return c(0,0);let r=Math.random()*10;Math.random()*10<1&&(r=Math.round(r)),r*=Math.sign(Math.random()*2-1);const i=Math.floor(Math.random()*t*2)-t;return u(r,i)}normalize(){if(this.m>=1&&this.m<10)return this;if(this.m===0)return this.m=0,this.e=0,this;const t=Math.floor(Math.log10(Math.abs(this.m)));return this.m=t===-324?this.m*10/1e-323:this.m/d(t),this.e+=t,this}toNumber(){if(!this.isFinite())return this.mantissa;if(this.e>308)return this.m>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;if(this.e<-324)return 0;if(this.e===-324)return this.m>0?5e-324:-5e-324;const t=this.m*d(this.e);if(!isFinite(t)||this.e<0)return t;const r=Math.round(t);return Math.abs(r-t)<1e-10?r:t}mantissaWithDecimalPlaces(t){if(!this.isFinite())return this.mantissa;if(this.m===0)return 0;const r=t+1,i=Math.ceil(Math.log10(Math.abs(this.m))),a=Math.round(this.m*Math.pow(10,r-i))*Math.pow(10,i-r);return parseFloat(a.toFixed(Math.max(r-i,0)))}toString(){return this.isFinite()?this.e<=-9e15||this.m===0?"0":this.e<21&&this.e>-7?this.toNumber().toString():this.m+"e"+(this.e>=0?"+":"")+this.e:this.mantissa.toString()}toExponential(t){if(!this.isFinite())return this.mantissa.toString();if(this.e<=-9e15||this.m===0)return"0"+p(t)+"e+0";if(this.e>-324&&this.e<308)return this.toNumber().toExponential(t);isFinite(t)||(t=17);const r=t+1,i=Math.max(1,Math.ceil(Math.log10(Math.abs(this.m))));return(Math.round(this.m*Math.pow(10,r-i))*Math.pow(10,i-r)).toFixed(Math.max(r-i,0))+"e"+(this.e>=0?"+":"")+this.e}toFixed(t){if(!this.isFinite())return this.mantissa.toString();if(this.e<=-9e15||this.m===0)return"0"+p(t);if(this.e>=17){const r=this.m.toString().replace(".",""),i=w(this.e-r.length+1);return r+i+p(t)}return this.toNumber().toFixed(t)}toPrecision(t){return this.e<=-7?this.toExponential(t-1):t>this.e?this.toFixed(t-this.e-1):this.toExponential(t-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(t){return this.toExponential(t)}pow_base(t){return e(t).pow(this)}factorial(){const t=this.toNumber()+1;return s.pow(t/Math.E*Math.sqrt(t*Math.sinh(1/t)+1/(810*Math.pow(t,6))),t).mul(Math.sqrt(2*Math.PI/t))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return s.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return s.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?Number.NaN:s.ln(this.add(1).div(new s(1).sub(this)))/2}ascensionPenalty(t){return t===0?this:this.pow(Math.pow(10,-t))}egg(){return this.add(9)}isFinite(){return isFinite(this.mantissa)}isNaN(){return this.mantissa!==this.mantissa}isPositiveInfinity(){return this.mantissa===S.mantissa}isNegativeInfinity(){return this.mantissa===T.mantissa}static const(t){return l(t)}static constant(t){return s.const(t)}static get ZERO(){return V}static get ONE(){return y}static get MINUS_ONE(){return R}static get MAX_VALUE(){return O}static get MIN_VALUE(){return G}static get NUMBER_MAX_VALUE(){return B}static get NUMBER_MIN_VALUE(){return C}static get NaN(){return M}static get POSITIVE_INFINITY(){return S}static get NEGATIVE_INFINITY(){return T}}const O=c(1,9e15),G=c(1,-9e15),V=l(0),y=l(1),R=l(-1),B=l(Number.MAX_VALUE),C=l(Number.MIN_VALUE),M=c(Number.NaN,0),S=c(Number.POSITIVE_INFINITY,0),T=c(Number.NEGATIVE_INFINITY,0);return s});
